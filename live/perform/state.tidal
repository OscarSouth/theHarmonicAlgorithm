bars = 2
tempo = 90

next <- gammaGen 1 0.3
  >>= \rns ->
  chainCadence sharp
  (initCadenceState (head rns) "B" [0,3,7])
  -- (lastCadence state)
  (harmonicContext
  -- overtones
    "*"
  -- tonality
    "*"
  -- roots
    "*"
  )
  4 -- len
  1 -- entropy

state = rotate (0) next

do
  let
    dyn = 0.8
    rep = bars
    s = transpose (0) state
    f = (swingBy 0.07 2)
    (d,r) = ((*dyn),rep)
  putStrLn . show $ s
  mapM_ id [hush, setbpm tempo
   ,p01 f s r $d 0.7
   ]
